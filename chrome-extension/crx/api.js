const e=new class{constructor(){this.handlers={},this.init()}init(){chrome.runtime.onMessage.addListener((async(e,a,s)=>{const{type:t,payload:n}=e,r=this.handlers[t];if(r){s({data:await r({data:n,sender:a})})}else s({data:"没找到函数"});return!0}))}sendMessage(e,a){return new Promise((s=>{chrome.runtime.sendMessage({type:e,payload:a},(e=>{s({data:e})}))}))}async sendTabMessage(e,a){const[s]=await chrome.tabs.query({active:!0,currentWindow:!0});return new Promise((t=>{chrome.tabs.sendMessage(s.id,{type:e,payload:a},(e=>{t({data:e})}))}))}onMessage(e,a){this.handlers[e]=a}};export{e as a};
